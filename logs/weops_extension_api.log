2023-03-21 11:43:51.321 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "GET",
        "url": "https://movie.douban.com/j/search_subjects/",
        "headers": {
            "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36"
        },
        "params": {},
        "data": "",
        "json": {}
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Date": "Tue, 21 Mar 2023 03:43:51 GMT",
            "Content-Type": "application/json; charset=utf-8",
            "Content-Length": "15",
            "Connection": "keep-alive",
            "Keep-Alive": "timeout=30",
            "X-Xss-Protection": "1; mode=block",
            "X-Douban-Mobileapp": "0",
            "Expires": "Sun, 1 Jan 2006 01:00:00 GMT",
            "Pragma": "no-cache",
            "Cache-Control": "must-revalidate, no-cache, private",
            "X-DAE-App": "movie",
            "X-DAE-Instance": "default",
            "Server": "dae",
            "Strict-Transport-Security": "max-age=15552000",
            "X-Content-Type-Options": "nosniff"
        },
        "data": {
            "subjects": []
        }
    }
}
2023-03-21 11:43:51.325 | MainThread | WARNING | performance : wrapper:59 -  The [func_name: _call] [func: <function BaseApiDefine._call at 0x00000217B2E8F048>] [args:(<core.bk_api_utils.main.DouBanHighMovieDefine object at 0x00000217B2E83F98>,)] [kwargs: {'headers': {'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36'}}] [timer:1.65181s] [threshold:0.5s], please timely optimize.
2023-03-21 11:43:51.331 | MainThread | ERROR | handlers : all_exception_handler:42 -  全局异常
URL:http://127.0.0.1:8080/api/douban/movies
Headers:Headers({'content-type': 'application/json', 'user-agent': 'PostmanRuntime/7.31.3', 'accept': '*/*', 'postman-token': 'aeb0bbaf-0a10-427a-a6a7-d11bd8f588af', 'host': '127.0.0.1:8080', 'accept-encoding': 'gzip, deflate, br', 'connection': 'keep-alive', 'content-length': '124'})
message:KeyError('tags',)
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 24, in __call__
    await responder(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 43, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\cors.py", line 84, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 93, in __call__
    raise exc
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    await self.app(scope, receive, sender)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 670, in __call__
    await route.handle(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 266, in handle
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 65, in app
    response = await func(request)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 228, in app
    dependant=dependant, values=values, is_coroutine=is_coroutine
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\server\apps\example\api\test_api.py", line 42, in get_high_movies
    return CommonResponseSchema(data=resp["tags"], message="操作成功", success=True)
KeyError: 'tags'

2023-03-21 11:48:06.337 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "GET",
        "url": "https://movie.douban.com/j/search_subjects/",
        "headers": {
            "User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36"
        },
        "params": {},
        "data": "",
        "json": {}
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Date": "Tue, 21 Mar 2023 03:48:06 GMT",
            "Content-Type": "application/json; charset=utf-8",
            "Content-Length": "15",
            "Connection": "keep-alive",
            "Keep-Alive": "timeout=30",
            "X-Xss-Protection": "1; mode=block",
            "X-Douban-Mobileapp": "0",
            "Expires": "Sun, 1 Jan 2006 01:00:00 GMT",
            "Pragma": "no-cache",
            "Cache-Control": "must-revalidate, no-cache, private",
            "X-DAE-App": "movie",
            "X-DAE-Instance": "default",
            "Server": "dae",
            "Strict-Transport-Security": "max-age=15552000",
            "X-Content-Type-Options": "nosniff"
        },
        "data": {
            "subjects": []
        }
    }
}
2023-03-21 11:48:06.342 | MainThread | WARNING | performance : wrapper:59 -  The [func_name: _call] [func: <function BaseApiDefine._call at 0x000001FF43980048>] [args:(<core.bk_api_utils.main.DouBanHighMovieDefine object at 0x000001FF43973FD0>,)] [kwargs: {'headers': {'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36'}}] [timer:0.59173s] [threshold:0.5s], please timely optimize.
2023-03-21 17:51:25.893 | MainThread | ERROR | handlers : all_exception_handler:42 -  全局异常
URL:http://127.0.0.1:8080/api/dingtalk
Headers:Headers({'content-type': 'application/json', 'user-agent': 'PostmanRuntime/7.31.3', 'accept': '*/*', 'postman-token': '05a552c9-bbfe-417b-be08-e0f8665cc381', 'host': '127.0.0.1:8080', 'accept-encoding': 'gzip, deflate, br', 'connection': 'keep-alive', 'content-length': '113'})
message:NameError("name 'get_token' is not defined",)
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 24, in __call__
    await responder(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 43, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\cors.py", line 84, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 93, in __call__
    raise exc
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    await self.app(scope, receive, sender)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 670, in __call__
    await route.handle(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 266, in handle
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 65, in app
    response = await func(request)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 228, in app
    dependant=dependant, values=values, is_coroutine=is_coroutine
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\server\apps\example\api\test_api.py", line 46, in get_high_movies
    resp = ApiManager.dingding.send_dingtalk()
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 65, in __call__
    return self._call(**kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\utils\performance.py", line 35, in wrapper
    result = func(*real_args, **real_kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 261, in _call
    access_token = get_token
NameError: name 'get_token' is not defined

2023-03-21 17:52:06.360 | MainThread | ERROR | handlers : all_exception_handler:42 -  全局异常
URL:http://127.0.0.1:8080/api/dingtalk
Headers:Headers({'content-type': 'application/json', 'user-agent': 'PostmanRuntime/7.31.3', 'accept': '*/*', 'postman-token': 'a54c5c09-e2ef-4b1c-aafb-af7a7155d3fb', 'host': '127.0.0.1:8080', 'accept-encoding': 'gzip, deflate, br', 'connection': 'keep-alive', 'content-length': '113'})
message:NameError("name 'headers' is not defined",)
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 24, in __call__
    await responder(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 43, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\cors.py", line 84, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 93, in __call__
    raise exc
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    await self.app(scope, receive, sender)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 670, in __call__
    await route.handle(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 266, in handle
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 65, in app
    response = await func(request)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 228, in app
    dependant=dependant, values=values, is_coroutine=is_coroutine
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\server\apps\example\api\test_api.py", line 46, in get_high_movies
    resp = ApiManager.dingding.send_dingtalk()
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 65, in __call__
    return self._call(**kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\utils\performance.py", line 35, in wrapper
    result = func(*real_args, **real_kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 261, in _call
    access_token = self.get_token()
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 244, in get_token
    res = requests.get(url=token_url, headers=headers, cookies=cookies, params=params, data=data)
NameError: name 'headers' is not defined

2023-03-21 17:52:46.738 | MainThread | ERROR | handlers : all_exception_handler:42 -  全局异常
URL:http://127.0.0.1:8080/api/dingtalk
Headers:Headers({'content-type': 'application/json', 'user-agent': 'PostmanRuntime/7.31.3', 'accept': '*/*', 'postman-token': '5dfa665a-79ea-41ef-8228-e7f740dcd6ef', 'host': '127.0.0.1:8080', 'accept-encoding': 'gzip, deflate, br', 'connection': 'keep-alive', 'content-length': '113'})
message:NameError("name 'headers' is not defined",)
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 24, in __call__
    await responder(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 43, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\cors.py", line 84, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 93, in __call__
    raise exc
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    await self.app(scope, receive, sender)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 670, in __call__
    await route.handle(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 266, in handle
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 65, in app
    response = await func(request)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 228, in app
    dependant=dependant, values=values, is_coroutine=is_coroutine
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\server\apps\example\api\test_api.py", line 46, in get_high_movies
    resp = ApiManager.dingding.send_dingtalk()
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 65, in __call__
    return self._call(**kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\utils\performance.py", line 35, in wrapper
    result = func(*real_args, **real_kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 261, in _call
    access_token = self.get_token()
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 244, in get_token
    res = requests.get(url=token_url, headers=headers, params=params, data=data)
NameError: name 'headers' is not defined

2023-03-21 17:53:10.064 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "get",
        "url": "https://oapi.dingtalk.com/gettoken",
        "headers": {},
        "params": {
            "appkey": "2480439072",
            "appsecret": "vTnxW2681P_dmq4P_7OQKwCwRqbTDYehMNITlrEwTJGKFQWkxRgW_C4XiRzs61SI"
        },
        "data": null,
        "json": ""
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Tue, 21 Mar 2023 09:53:10 GMT",
            "Content-Type": "application/json",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 40096,
            "errmsg": "\u4e0d\u5408\u6cd5\u7684appKey\u6216appSecret"
        }
    }
}
2023-03-21 17:53:10.074 | MainThread | ERROR | handlers : all_exception_handler:42 -  全局异常
URL:http://127.0.0.1:8080/api/dingtalk
Headers:Headers({'content-type': 'application/json', 'user-agent': 'PostmanRuntime/7.31.3', 'accept': '*/*', 'postman-token': '9b0bba36-b26f-4433-abff-984fc0deacb1', 'host': '127.0.0.1:8080', 'accept-encoding': 'gzip, deflate, br', 'connection': 'keep-alive', 'content-length': '113'})
message:KeyError('access_token',)
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 24, in __call__
    await responder(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 43, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\cors.py", line 84, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 93, in __call__
    raise exc
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    await self.app(scope, receive, sender)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 670, in __call__
    await route.handle(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 266, in handle
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 65, in app
    response = await func(request)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 228, in app
    dependant=dependant, values=values, is_coroutine=is_coroutine
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\server\apps\example\api\test_api.py", line 46, in get_high_movies
    resp = ApiManager.dingding.send_dingtalk()
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 65, in __call__
    return self._call(**kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\utils\performance.py", line 35, in wrapper
    result = func(*real_args, **real_kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 261, in _call
    access_token = self.get_token()
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 245, in get_token
    return res.json()["access_token"]
KeyError: 'access_token'

2023-03-21 17:54:39.993 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "get",
        "url": "https://oapi.dingtalk.com/gettoken",
        "headers": {},
        "params": {
            "appkey": "dingdrvtrc1zzd6wohwf",
            "appsecret": "vTnxW2681P_dmq4P_7OQKwCwRqbTDYehMNITlrEwTJGKFQWkxRgW_C4XiRzs61SI"
        },
        "data": null,
        "json": ""
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Tue, 21 Mar 2023 09:54:39 GMT",
            "Content-Type": "application/json",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "access_token": "8ac2a79ce5c23210a7cb8197e260ac58",
            "errmsg": "ok",
            "expires_in": 7200
        }
    }
}
2023-03-21 17:54:39.999 | MainThread | ERROR | handlers : all_exception_handler:42 -  全局异常
URL:http://127.0.0.1:8080/api/dingtalk
Headers:Headers({'content-type': 'application/json', 'user-agent': 'PostmanRuntime/7.31.3', 'accept': '*/*', 'postman-token': '45fdbeab-67ac-4cfa-a1aa-57302b59274e', 'host': '127.0.0.1:8080', 'accept-encoding': 'gzip, deflate, br', 'connection': 'keep-alive', 'content-length': '113'})
message:NameError("name 'moblie' is not defined",)
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 24, in __call__
    await responder(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 43, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\cors.py", line 84, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 93, in __call__
    raise exc
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    await self.app(scope, receive, sender)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 670, in __call__
    await route.handle(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 266, in handle
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 65, in app
    response = await func(request)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 228, in app
    dependant=dependant, values=values, is_coroutine=is_coroutine
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\server\apps\example\api\test_api.py", line 46, in get_high_movies
    resp = ApiManager.dingding.send_dingtalk()
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 65, in __call__
    return self._call(**kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\utils\performance.py", line 35, in wrapper
    result = func(*real_args, **real_kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 267, in _call
    user_id = self.get_userid(access_token, mobile)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 250, in get_userid
    "mobile": moblie
NameError: name 'moblie' is not defined

2023-03-21 17:55:32.909 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "get",
        "url": "https://oapi.dingtalk.com/gettoken",
        "headers": {},
        "params": {
            "appkey": "dingdrvtrc1zzd6wohwf",
            "appsecret": "vTnxW2681P_dmq4P_7OQKwCwRqbTDYehMNITlrEwTJGKFQWkxRgW_C4XiRzs61SI"
        },
        "data": null,
        "json": ""
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Tue, 21 Mar 2023 09:55:32 GMT",
            "Content-Type": "application/json",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "access_token": "8ac2a79ce5c23210a7cb8197e260ac58",
            "errmsg": "ok",
            "expires_in": 7200
        }
    }
}
2023-03-21 17:55:32.916 | MainThread | ERROR | handlers : all_exception_handler:42 -  全局异常
URL:http://127.0.0.1:8080/api/dingtalk
Headers:Headers({'content-type': 'application/json', 'user-agent': 'PostmanRuntime/7.31.3', 'accept': '*/*', 'postman-token': '1b0eaa89-adca-4a90-a8f6-0fb4f6aecfe4', 'host': '127.0.0.1:8080', 'accept-encoding': 'gzip, deflate, br', 'connection': 'keep-alive', 'content-length': '113'})
message:NameError("name 'moblie' is not defined",)
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 24, in __call__
    await responder(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 43, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\cors.py", line 84, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 93, in __call__
    raise exc
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    await self.app(scope, receive, sender)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 670, in __call__
    await route.handle(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 266, in handle
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 65, in app
    response = await func(request)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 228, in app
    dependant=dependant, values=values, is_coroutine=is_coroutine
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\server\apps\example\api\test_api.py", line 46, in get_high_movies
    resp = ApiManager.dingding.send_dingtalk()
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 65, in __call__
    return self._call(**kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\utils\performance.py", line 35, in wrapper
    result = func(*real_args, **real_kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 267, in _call
    user_id = self.get_userid(access_token, mobile)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 250, in get_userid
    "mobile": moblie
NameError: name 'moblie' is not defined

2023-03-21 17:55:58.693 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "get",
        "url": "https://oapi.dingtalk.com/gettoken",
        "headers": {},
        "params": {
            "appkey": "dingdrvtrc1zzd6wohwf",
            "appsecret": "vTnxW2681P_dmq4P_7OQKwCwRqbTDYehMNITlrEwTJGKFQWkxRgW_C4XiRzs61SI"
        },
        "data": null,
        "json": ""
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Tue, 21 Mar 2023 09:55:58 GMT",
            "Content-Type": "application/json",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "access_token": "8ac2a79ce5c23210a7cb8197e260ac58",
            "errmsg": "ok",
            "expires_in": 7200
        }
    }
}
2023-03-21 17:55:58.847 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "post",
        "url": "https://oapi.dingtalk.com/topapi/v2/user/getbymobile",
        "headers": {},
        "params": {
            "access_token": "8ac2a79ce5c23210a7cb8197e260ac58"
        },
        "data": {
            "mobile": {}
        },
        "json": null
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Tue, 21 Mar 2023 09:55:58 GMT",
            "Content-Type": "application/json;charset=UTF-8",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Application-Host": "33.79.137.27",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 40,
            "errmsg": "Missing required arguments:mobile",
            "request_id": "15rgj7pcwbbgf"
        }
    }
}
2023-03-21 17:55:58.855 | MainThread | ERROR | handlers : all_exception_handler:42 -  全局异常
URL:http://127.0.0.1:8080/api/dingtalk
Headers:Headers({'content-type': 'application/json', 'user-agent': 'PostmanRuntime/7.31.3', 'accept': '*/*', 'postman-token': '978e0e12-d0cd-4aa1-8920-30571ba69759', 'host': '127.0.0.1:8080', 'accept-encoding': 'gzip, deflate, br', 'connection': 'keep-alive', 'content-length': '113'})
message:TypeError("'Response' object is not subscriptable",)
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 24, in __call__
    await responder(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 43, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\cors.py", line 84, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 93, in __call__
    raise exc
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    await self.app(scope, receive, sender)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 670, in __call__
    await route.handle(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 266, in handle
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 65, in app
    response = await func(request)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 228, in app
    dependant=dependant, values=values, is_coroutine=is_coroutine
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\server\apps\example\api\test_api.py", line 46, in get_high_movies
    resp = ApiManager.dingding.send_dingtalk()
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 65, in __call__
    return self._call(**kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\utils\performance.py", line 35, in wrapper
    result = func(*real_args, **real_kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 267, in _call
    user_id = self.get_userid(access_token, mobile)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 257, in get_userid
    return res["result"]["userid"]
TypeError: 'Response' object is not subscriptable

2023-03-21 17:56:20.069 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "get",
        "url": "https://oapi.dingtalk.com/gettoken",
        "headers": {},
        "params": {
            "appkey": "dingdrvtrc1zzd6wohwf",
            "appsecret": "vTnxW2681P_dmq4P_7OQKwCwRqbTDYehMNITlrEwTJGKFQWkxRgW_C4XiRzs61SI"
        },
        "data": null,
        "json": ""
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Tue, 21 Mar 2023 09:56:20 GMT",
            "Content-Type": "application/json",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "access_token": "8ac2a79ce5c23210a7cb8197e260ac58",
            "errmsg": "ok",
            "expires_in": 7200
        }
    }
}
2023-03-21 17:56:20.231 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "post",
        "url": "https://oapi.dingtalk.com/topapi/v2/user/getbymobile",
        "headers": {},
        "params": {
            "access_token": "8ac2a79ce5c23210a7cb8197e260ac58"
        },
        "data": {
            "mobile": {}
        },
        "json": null
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Tue, 21 Mar 2023 09:56:20 GMT",
            "Content-Type": "application/json;charset=UTF-8",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Application-Host": "33.79.137.190",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 40,
            "errmsg": "Missing required arguments:mobile",
            "request_id": "15runfv2lpp5q"
        }
    }
}
2023-03-21 17:56:20.238 | MainThread | ERROR | handlers : all_exception_handler:42 -  全局异常
URL:http://127.0.0.1:8080/api/dingtalk
Headers:Headers({'content-type': 'application/json', 'user-agent': 'PostmanRuntime/7.31.3', 'accept': '*/*', 'postman-token': '8e5101dc-caf6-4fad-bcdb-de046fdc3e81', 'host': '127.0.0.1:8080', 'accept-encoding': 'gzip, deflate, br', 'connection': 'keep-alive', 'content-length': '113'})
message:KeyError('result',)
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 24, in __call__
    await responder(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 43, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\cors.py", line 84, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 93, in __call__
    raise exc
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    await self.app(scope, receive, sender)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 670, in __call__
    await route.handle(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 266, in handle
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 65, in app
    response = await func(request)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 228, in app
    dependant=dependant, values=values, is_coroutine=is_coroutine
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\server\apps\example\api\test_api.py", line 46, in get_high_movies
    resp = ApiManager.dingding.send_dingtalk()
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 65, in __call__
    return self._call(**kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\utils\performance.py", line 35, in wrapper
    result = func(*real_args, **real_kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 267, in _call
    user_id = self.get_userid(access_token, mobile)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 257, in get_userid
    return res.json()["result"]["userid"]
KeyError: 'result'

2023-03-21 18:40:58.497 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "get",
        "url": "https://oapi.dingtalk.com/gettoken",
        "headers": {},
        "params": {
            "appkey": "dingdrvtrc1zzd6wohwf",
            "appsecret": "vTnxW2681P_dmq4P_7OQKwCwRqbTDYehMNITlrEwTJGKFQWkxRgW_C4XiRzs61SI"
        },
        "data": "null",
        "json": ""
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Tue, 21 Mar 2023 10:40:58 GMT",
            "Content-Type": "application/json",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "access_token": "8ac2a79ce5c23210a7cb8197e260ac58",
            "errmsg": "ok",
            "expires_in": 7200
        }
    }
}
2023-03-21 18:40:58.652 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "post",
        "url": "https://oapi.dingtalk.com/topapi/v2/user/getbymobile",
        "headers": {},
        "params": {
            "access_token": "8ac2a79ce5c23210a7cb8197e260ac58"
        },
        "data": {
            "mobile": {}
        },
        "json": null
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Tue, 21 Mar 2023 10:40:58 GMT",
            "Content-Type": "application/json;charset=UTF-8",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Application-Host": "33.79.187.233",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 40,
            "errmsg": "Missing required arguments:mobile",
            "request_id": "16mqzc1dzr2zv"
        }
    }
}
2023-03-21 18:40:58.661 | MainThread | ERROR | handlers : all_exception_handler:42 -  全局异常
URL:http://127.0.0.1:8080/api/dingtalk
Headers:Headers({'content-type': 'application/json', 'user-agent': 'PostmanRuntime/7.31.3', 'accept': '*/*', 'postman-token': 'aec2fb70-05ef-4008-91bf-63400b81ee31', 'host': '127.0.0.1:8080', 'accept-encoding': 'gzip, deflate, br', 'connection': 'keep-alive', 'content-length': '113'})
message:KeyError('result',)
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 24, in __call__
    await responder(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 43, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\cors.py", line 84, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 93, in __call__
    raise exc
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    await self.app(scope, receive, sender)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 670, in __call__
    await route.handle(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 266, in handle
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 65, in app
    response = await func(request)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 228, in app
    dependant=dependant, values=values, is_coroutine=is_coroutine
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\server\apps\example\api\test_api.py", line 46, in get_high_movies
    resp = ApiManager.dingding.send_dingtalk()
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 65, in __call__
    return self._call(**kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\utils\performance.py", line 35, in wrapper
    result = func(*real_args, **real_kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 267, in _call
    user_id = self.get_userid(access_token, mobile)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 257, in get_userid
    return res.json()["result"]["userid"]
KeyError: 'result'

2023-03-21 18:42:19.901 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "get",
        "url": "https://oapi.dingtalk.com/gettoken",
        "headers": {},
        "params": {
            "appkey": "dingdrvtrc1zzd6wohwf",
            "appsecret": "vTnxW2681P_dmq4P_7OQKwCwRqbTDYehMNITlrEwTJGKFQWkxRgW_C4XiRzs61SI"
        },
        "data": "null",
        "json": ""
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Tue, 21 Mar 2023 10:42:19 GMT",
            "Content-Type": "application/json",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "access_token": "8ac2a79ce5c23210a7cb8197e260ac58",
            "errmsg": "ok",
            "expires_in": 7200
        }
    }
}
2023-03-21 18:42:20.029 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "post",
        "url": "https://oapi.dingtalk.com/topapi/v2/user/getbymobile",
        "headers": {},
        "params": {
            "access_token": "8ac2a79ce5c23210a7cb8197e260ac58"
        },
        "data": {
            "mobile": {}
        },
        "json": null
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Tue, 21 Mar 2023 10:42:20 GMT",
            "Content-Type": "application/json;charset=UTF-8",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Application-Host": "33.79.187.184",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 40,
            "errmsg": "Missing required arguments:mobile",
            "request_id": "16mmqjytu6zby"
        }
    }
}
2023-03-21 18:42:20.030 | MainThread | ERROR | main : get_userid:257 -  {'errcode': 40, 'errmsg': 'Missing required arguments:mobile', 'request_id': '16mmqjytu6zby'}
2023-03-21 18:42:20.032 | MainThread | ERROR | main : get_userid:258 -  {}
2023-03-21 18:42:20.037 | MainThread | ERROR | handlers : all_exception_handler:42 -  全局异常
URL:http://127.0.0.1:8080/api/dingtalk
Headers:Headers({'content-type': 'application/json', 'user-agent': 'PostmanRuntime/7.31.3', 'accept': '*/*', 'postman-token': '264b8b91-c1dc-49d7-a8a0-10ca252e44f1', 'host': '127.0.0.1:8080', 'accept-encoding': 'gzip, deflate, br', 'connection': 'keep-alive', 'content-length': '113'})
message:KeyError('result',)
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 24, in __call__
    await responder(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 43, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\cors.py", line 84, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 93, in __call__
    raise exc
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    await self.app(scope, receive, sender)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 670, in __call__
    await route.handle(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 266, in handle
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 65, in app
    response = await func(request)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 228, in app
    dependant=dependant, values=values, is_coroutine=is_coroutine
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\server\apps\example\api\test_api.py", line 46, in get_high_movies
    resp = ApiManager.dingding.send_dingtalk()
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 65, in __call__
    return self._call(**kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\utils\performance.py", line 35, in wrapper
    result = func(*real_args, **real_kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 269, in _call
    user_id = self.get_userid(access_token, mobile)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 259, in get_userid
    return res.json()["result"]["userid"]
KeyError: 'result'

2023-03-22 11:10:20.250 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "get",
        "url": "https://oapi.dingtalk.com/gettoken",
        "headers": {},
        "params": {
            "appkey": "dingdrvtrc1zzd6wohwf",
            "appsecret": "vTnxW2681P_dmq4P_7OQKwCwRqbTDYehMNITlrEwTJGKFQWkxRgW_C4XiRzs61SI"
        },
        "data": "null",
        "json": ""
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Wed, 22 Mar 2023 03:10:20 GMT",
            "Content-Type": "application/json",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "access_token": "84114825a012389ea2a017d33caab748",
            "errmsg": "ok",
            "expires_in": 7200
        }
    }
}
2023-03-22 11:10:20.386 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "post",
        "url": "https://oapi.dingtalk.com/topapi/v2/user/getbymobile",
        "headers": {},
        "params": {
            "access_token": "84114825a012389ea2a017d33caab748"
        },
        "data": {
            "mobile": {}
        },
        "json": null
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Wed, 22 Mar 2023 03:10:20 GMT",
            "Content-Type": "application/json;charset=UTF-8",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Application-Host": "33.79.136.201",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 40,
            "errmsg": "Missing required arguments:mobile",
            "request_id": "15r9fkb9lcxug"
        }
    }
}
2023-03-22 11:10:20.389 | MainThread | ERROR | main : get_userid:257 -  {'errcode': 40, 'errmsg': 'Missing required arguments:mobile', 'request_id': '15r9fkb9lcxug'}
2023-03-22 11:10:20.390 | MainThread | ERROR | main : get_userid:258 -  {}
2023-03-22 11:10:20.418 | MainThread | ERROR | handlers : all_exception_handler:42 -  全局异常
URL:http://127.0.0.1:8080/api/dingtalk
Headers:Headers({'content-type': 'application/json', 'user-agent': 'PostmanRuntime/7.31.3', 'accept': '*/*', 'postman-token': '60208a71-2dc1-4635-ac29-254062aa13db', 'host': '127.0.0.1:8080', 'accept-encoding': 'gzip, deflate, br', 'connection': 'keep-alive', 'content-length': '113'})
message:KeyError('result',)
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 24, in __call__
    await responder(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 43, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\cors.py", line 84, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 93, in __call__
    raise exc
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    await self.app(scope, receive, sender)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 670, in __call__
    await route.handle(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 266, in handle
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 65, in app
    response = await func(request)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 228, in app
    dependant=dependant, values=values, is_coroutine=is_coroutine
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\server\apps\example\api\test_api.py", line 46, in get_high_movies
    resp = ApiManager.dingding.send_dingtalk()
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 65, in __call__
    return self._call(**kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\utils\performance.py", line 35, in wrapper
    result = func(*real_args, **real_kwargs)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 269, in _call
    user_id = self.get_userid(access_token, mobile)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\core\bk_api_utils\main.py", line 259, in get_userid
    return res.json()["result"]["userid"]
KeyError: 'result'

2023-03-22 11:13:17.386 | MainThread | ERROR | handlers : all_exception_handler:42 -  全局异常
URL:http://127.0.0.1:8080/api/dingtalk
Headers:Headers({'content-type': 'application/json', 'user-agent': 'PostmanRuntime/7.31.3', 'accept': '*/*', 'postman-token': '6c1ea47c-1bcf-4032-aee6-4a22d9b16018', 'host': '127.0.0.1:8080', 'accept-encoding': 'gzip, deflate, br', 'connection': 'keep-alive', 'content-length': '113'})
message:TypeError("__init__() missing 1 required positional argument: 'params'",)
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 24, in __call__
    await responder(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 43, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\cors.py", line 84, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 93, in __call__
    raise exc
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    await self.app(scope, receive, sender)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 670, in __call__
    await route.handle(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 266, in handle
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 65, in app
    response = await func(request)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 228, in app
    dependant=dependant, values=values, is_coroutine=is_coroutine
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\server\apps\msg\api\msg_api.py", line 27, in get_high_movies
    dingding =DingDing()
TypeError: __init__() missing 1 required positional argument: 'params'

2023-03-22 11:16:06.429 | MainThread | ERROR | handlers : all_exception_handler:42 -  全局异常
URL:http://127.0.0.1:8080/api/dingtalk
Headers:Headers({'content-type': 'application/json', 'user-agent': 'PostmanRuntime/7.31.3', 'accept': '*/*', 'postman-token': '020a80df-74e4-49c6-a48c-4f7bbea4d870', 'host': '127.0.0.1:8080', 'accept-encoding': 'gzip, deflate, br', 'connection': 'keep-alive', 'content-length': '113'})
message:TypeError("__init__() missing 1 required positional argument: 'params'",)
Traceback (most recent call last):
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\errors.py", line 162, in __call__
    await self.app(scope, receive, _send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 24, in __call__
    await responder(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\gzip.py", line 43, in __call__
    await self.app(scope, receive, self.send_with_gzip)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\middleware\cors.py", line 84, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 93, in __call__
    raise exc
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\exceptions.py", line 82, in __call__
    await self.app(scope, receive, sender)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 21, in __call__
    raise e
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 670, in __call__
    await route.handle(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 266, in handle
    await self.app(scope, receive, send)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\starlette\routing.py", line 65, in app
    response = await func(request)
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 228, in app
    dependant=dependant, values=values, is_coroutine=is_coroutine
  File "C:\ProgramData\Anaconda3\envs\weops_extension_api\lib\site-packages\fastapi\routing.py", line 160, in run_endpoint_function
    return await dependant.call(**values)
  File "C:\Users\Icoy\OneDrive\Work\Summary\WeOps\Code\Python\消息通道对接\bk-msg\server\apps\msg\api\msg_api.py", line 27, in get_high_movies
    dingding =DingDing()
TypeError: __init__() missing 1 required positional argument: 'params'

2023-03-22 11:18:02.236 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "get",
        "url": "https://oapi.dingtalk.com/gettoken",
        "headers": {},
        "params": {
            "appkey": "dingdrvtrc1zzd6wohwf",
            "appsecret": "vTnxW2681P_dmq4P_7OQKwCwRqbTDYehMNITlrEwTJGKFQWkxRgW_C4XiRzs61SI"
        },
        "data": "",
        "json": ""
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Wed, 22 Mar 2023 03:18:02 GMT",
            "Content-Type": "application/json",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "access_token": "84114825a012389ea2a017d33caab748",
            "errmsg": "ok",
            "expires_in": 7200
        }
    }
}
2023-03-22 11:18:02.384 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "post",
        "url": "https://oapi.dingtalk.com/topapi/v2/user/getbymobile",
        "headers": {},
        "params": {
            "access_token": "84114825a012389ea2a017d33caab748"
        },
        "data": "{\"mobile\": \"17620800563\"}",
        "json": null
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Wed, 22 Mar 2023 03:18:02 GMT",
            "Content-Type": "application/json;charset=UTF-8",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Application-Host": "33.79.138.219",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "errmsg": "ok",
            "result": {
                "userid": "manager6161"
            },
            "request_id": "15sjc2w8lungz"
        }
    }
}
2023-03-22 11:18:02.524 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "post",
        "url": "https://oapi.dingtalk.com/topapi/message/corpconversation/asyncsend_v2",
        "headers": {},
        "params": {},
        "data": "{\"agent_id\": \"2480439072\", \"userid_list\": \"manager6161\", \"msg\": {\"msgtype\": \"text\", \"text\": {\"content\": \"\\u8bf7\\u63d0\\u4ea4\\u65e5\\u62a5\\u3002\"}}}",
        "json": null
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Wed, 22 Mar 2023 03:18:02 GMT",
            "Content-Type": "application/json;charset=UTF-8",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Application-Host": "33.79.139.49",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 88,
            "sub_code": "40000",
            "sub_msg": "access_token is blank",
            "errmsg": "ding talk error[subcode=40000,submsg=access_token is blank]",
            "request_id": "15sqs830465qd"
        }
    }
}
2023-03-22 11:21:09.923 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "get",
        "url": "https://oapi.dingtalk.com/gettoken",
        "headers": {},
        "params": {
            "appkey": "dingdrvtrc1zzd6wohwf",
            "appsecret": "vTnxW2681P_dmq4P_7OQKwCwRqbTDYehMNITlrEwTJGKFQWkxRgW_C4XiRzs61SI"
        },
        "data": "",
        "json": ""
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Wed, 22 Mar 2023 03:21:09 GMT",
            "Content-Type": "application/json",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "access_token": "84114825a012389ea2a017d33caab748",
            "errmsg": "ok",
            "expires_in": 7200
        }
    }
}
2023-03-22 11:21:10.070 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "post",
        "url": "https://oapi.dingtalk.com/topapi/v2/user/getbymobile",
        "headers": {},
        "params": {
            "access_token": "84114825a012389ea2a017d33caab748"
        },
        "data": "{\"mobile\": \"17620800563\"}",
        "json": null
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Wed, 22 Mar 2023 03:21:09 GMT",
            "Content-Type": "application/json;charset=UTF-8",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Application-Host": "33.79.186.144",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "errmsg": "ok",
            "result": {
                "userid": "manager6161"
            },
            "request_id": "16lx3ntoyuva6"
        }
    }
}
2023-03-22 11:21:10.201 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "post",
        "url": "https://oapi.dingtalk.com/topapi/message/corpconversation/asyncsend_v2",
        "headers": {},
        "params": {},
        "data": "{\"agent_id\": \"2480439072\", \"userid_list\": \"manager6161\", \"msg\": {\"msgtype\": \"text\", \"text\": {\"content\": \"\\u8bf7\\u63d0\\u4ea4\\u65e5\\u62a5\\u3002\"}}}",
        "json": null
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Wed, 22 Mar 2023 03:21:10 GMT",
            "Content-Type": "application/json;charset=UTF-8",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Application-Host": "33.79.187.35",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 88,
            "sub_code": "40000",
            "sub_msg": "access_token is blank",
            "errmsg": "ding talk error[subcode=40000,submsg=access_token is blank]",
            "request_id": "16m9u01hkgzwr"
        }
    }
}
2023-03-22 11:21:47.081 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "get",
        "url": "https://oapi.dingtalk.com/gettoken",
        "headers": {},
        "params": {
            "appkey": "dingdrvtrc1zzd6wohwf",
            "appsecret": "vTnxW2681P_dmq4P_7OQKwCwRqbTDYehMNITlrEwTJGKFQWkxRgW_C4XiRzs61SI"
        },
        "data": "",
        "json": ""
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Wed, 22 Mar 2023 03:21:46 GMT",
            "Content-Type": "application/json",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "access_token": "84114825a012389ea2a017d33caab748",
            "errmsg": "ok",
            "expires_in": 7200
        }
    }
}
2023-03-22 11:21:47.221 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "post",
        "url": "https://oapi.dingtalk.com/topapi/v2/user/getbymobile",
        "headers": {},
        "params": {
            "access_token": "84114825a012389ea2a017d33caab748"
        },
        "data": "{\"mobile\": \"17620800563\"}",
        "json": null
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Wed, 22 Mar 2023 03:21:47 GMT",
            "Content-Type": "application/json;charset=UTF-8",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Application-Host": "33.79.138.48",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "errmsg": "ok",
            "result": {
                "userid": "manager6161"
            },
            "request_id": "15s4iwrop5syc"
        }
    }
}
2023-03-22 11:21:47.397 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "post",
        "url": "https://oapi.dingtalk.com/topapi/message/corpconversation/asyncsend_v2",
        "headers": {},
        "params": {
            "access_token": "84114825a012389ea2a017d33caab748"
        },
        "data": "{\"agent_id\": \"2480439072\", \"userid_list\": \"manager6161\", \"msg\": {\"msgtype\": \"text\", \"text\": {\"content\": \"\\u8bf7\\u63d0\\u4ea4\\u65e5\\u62a5\\u3002\"}}}",
        "json": null
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Wed, 22 Mar 2023 03:21:47 GMT",
            "Content-Type": "application/json;charset=UTF-8",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Application-Host": "33.79.136.241",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "errmsg": "ok",
            "task_id": 2838192234195,
            "request_id": "15rcwa6d39wdl"
        }
    }
}
2023-03-22 11:23:10.630 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "get",
        "url": "https://oapi.dingtalk.com/gettoken",
        "headers": {},
        "params": {
            "appkey": "dingdrvtrc1zzd6wohwf",
            "appsecret": "vTnxW2681P_dmq4P_7OQKwCwRqbTDYehMNITlrEwTJGKFQWkxRgW_C4XiRzs61SI"
        },
        "data": "",
        "json": ""
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Wed, 22 Mar 2023 03:23:10 GMT",
            "Content-Type": "application/json",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "access_token": "84114825a012389ea2a017d33caab748",
            "errmsg": "ok",
            "expires_in": 7200
        }
    }
}
2023-03-22 11:23:10.794 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "post",
        "url": "https://oapi.dingtalk.com/topapi/v2/user/getbymobile",
        "headers": {},
        "params": {
            "access_token": "84114825a012389ea2a017d33caab748"
        },
        "data": "{\"mobile\": \"17620800563\"}",
        "json": null
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Wed, 22 Mar 2023 03:23:10 GMT",
            "Content-Type": "application/json;charset=UTF-8",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Application-Host": "33.79.137.174",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "errmsg": "ok",
            "result": {
                "userid": "manager6161"
            },
            "request_id": "15rt9kqpk367i"
        }
    }
}
2023-03-22 11:23:10.940 | MainThread | INFO | patch : new_request:42 -  {
    "request": {
        "method": "post",
        "url": "https://oapi.dingtalk.com/topapi/message/corpconversation/asyncsend_v2",
        "headers": {},
        "params": {
            "access_token": "84114825a012389ea2a017d33caab748"
        },
        "data": "{\"agent_id\": \"2480439072\", \"userid_list\": \"manager6161\", \"msg\": {\"msgtype\": \"text\", \"text\": {\"content\": \"\\u6d4b\\u8bd5\\u6d88\\u606f\"}}}",
        "json": null
    },
    "response": {
        "status_code": 200,
        "headers": {
            "Server": "DingTalk/1.0.0",
            "Date": "Wed, 22 Mar 2023 03:23:10 GMT",
            "Content-Type": "application/json;charset=UTF-8",
            "Transfer-Encoding": "chunked",
            "Connection": "keep-alive",
            "Application-Host": "33.79.139.95",
            "Cache-Control": "no-cache",
            "Content-Encoding": "gzip"
        },
        "data": {
            "errcode": 0,
            "errmsg": "ok",
            "task_id": 2838653205958,
            "request_id": "15surnf4zc45n"
        }
    }
}
